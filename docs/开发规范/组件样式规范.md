# 组件样式规范指南

> **版本**: v2.0  
> **更新日期**: 2025-12-28  
> **适用项目**: dhs-atlas（AI 原生工作操作系统）

---

## 一、技术栈约束

### 1.1 UI 组件库（唯一）

| 技术 | 说明 | 状态 |
|------|------|------|
| **shadcn/ui** | 唯一允许的 UI 组件库 | **强制** |
| Radix UI | shadcn 底层依赖 | 允许 |
| Tailwind CSS v4 | 样式框架 | **强制** |
| Lucide React | 唯一允许的图标库 | **强制** |

### 1.2 禁止使用

| 禁止项 | 原因 |
|-------|------|
| Ant Design | 引入第二套 UI 体系 |
| Material UI | 引入第二套 UI 体系 |
| Chakra UI | 引入第二套 UI 体系 |
| 其他 UI 组件库 | 破坏系统一致性 |
| Emoji | AI 无法解析 |
| 自建基础组件 | 破坏可预测性 |

---

## 二、组件分类与规范

### 2.1 基础组件（shadcn/ui）

#### 表单输入类

| 组件 | shadcn 组件 | 使用场景 | 样式规范 |
|------|------------|---------|---------|
| 文本输入 | `Input` | 单行文本 | 使用默认样式，通过 className 扩展 |
| 数字输入 | `Input type="number"` | 数字 | 配合 zod 验证 |
| 多行文本 | `Textarea` | 长文本 | 统一 rows 属性 |
| 下拉选择 | `Select` | 单选 | 使用 shadcn Select |
| 多选 | `Checkbox` | 多选 | 配合 CheckboxGroup |
| 单选 | `RadioGroup` | 单选组 | 使用 RadioGroup |
| 日期选择 | `Calendar` + `Popover` | 日期 | 统一格式 YYYY-MM-DD |
| 开关 | `Switch` | 布尔 | 配合 Label |
| 滑块 | `Slider` | 范围值 | 显示数值标签 |

#### 显示类

| 组件 | shadcn 组件 | 使用场景 | 样式规范 |
|------|------------|---------|---------|
| 卡片 | `Card` | 内容容器 | 使用 CardHeader/CardContent |
| 徽章 | `Badge` | 状态标签 | 使用 variant 属性 |
| 头像 | `Avatar` | 用户头像 | 统一尺寸规范 |
| 提示 | `Tooltip` | 悬停提示 | 简短文本 |
| 进度 | `Progress` | 进度指示 | 真实进度，禁止假进度 |

#### 交互类

| 组件 | shadcn 组件 | 使用场景 | 样式规范 |
|------|------------|---------|---------|
| 按钮 | `Button` | 操作触发 | 使用 variant/size |
| 对话框 | `Dialog` | 模态弹窗 | 重要操作确认 |
| 抽屉 | `Sheet` | 侧边面板 | 表单编辑 |
| 下拉菜单 | `DropdownMenu` | 操作菜单 | 行操作 |
| 命令面板 | `Command` | 命令搜索 | 全局命令入口 |
| 标签页 | `Tabs` | 内容切换 | 同级内容 |

### 2.2 布局组件

| 组件 | 实现方式 | 使用场景 | 样式规范 |
|------|---------|---------|---------|
| 栅格布局 | Tailwind Grid | 多列布局 | `grid grid-cols-*` |
| Flex 布局 | Tailwind Flex | 弹性布局 | `flex items-center` |
| 分割线 | `Separator` | 内容分隔 | shadcn Separator |
| 滚动区域 | `ScrollArea` | 可滚动容器 | shadcn ScrollArea |

### 2.3 数据展示组件

| 组件 | 实现方式 | 使用场景 | 样式规范 |
|------|---------|---------|---------|
| 表格 | `Table` + TanStack Table | 数据列表 | shadcn Table |
| 列表 | 自定义 + shadcn | 简单列表 | 使用 Card 包装 |
| 描述列表 | 自定义 | 详情展示 | 键值对形式 |
| 空状态 | 自定义 | 无数据 | 统一空状态组件 |

---

## 三、AI 交互原语组件

dhs-atlas 定义了 8 个交互原语，AI 只能调用这些已注册的组件：

### 3.1 AiForm - 表单组件

```tsx
// AI 请求渲染
{
  "ui": {
    "componentId": "AiForm",
    "props": {
      "title": "创建客户",
      "schemaId": "client.create",
      "initialValues": { "type": "enterprise" }
    }
  }
}
```

**Props Schema**:
- `title`: 表单标题
- `schemaId`: 表单 Schema ID
- `initialValues`: 初始值
- `readOnly`: 是否只读

**Events**:
- `ui.submit`: 表单提交
- `ui.cancel`: 取消操作
- `ui.update`: 字段更新

### 3.2 AiPicker - 选择器组件

```tsx
// 单选
<AiPicker
  mode="single"
  options={[
    { value: 'enterprise', label: '企业' },
    { value: 'individual', label: '个人' },
  ]}
/>

// 多选
<AiPicker
  mode="multiple"
  options={options}
  maxSelect={3}
/>
```

### 3.3 AiList - 列表组件

```tsx
<AiList
  dataSource={clients}
  columns={columns}
  selectable
  filterable
  pagination
/>
```

### 3.4 AiDetails - 详情组件

```tsx
<AiDetails
  title="客户详情"
  data={client}
  fields={[
    { key: 'name', label: '客户名称' },
    { key: 'type', label: '客户类型' },
    { key: 'createdAt', label: '创建时间', format: 'date' },
  ]}
/>
```

### 3.5 AiModalConfirm - 确认弹窗

```tsx
<AiModalConfirm
  type="warning" // info | warning | danger
  title="确认删除"
  description="删除后无法恢复，是否继续？"
  confirmText="确认删除"
  cancelText="取消"
/>
```

### 3.6 AiReviewPanel - 审批面板

```tsx
<AiReviewPanel
  items={patches}
  columns={['原文', '修改建议', '风险等级']}
  actions={['approve', 'reject', 'modify']}
/>
```

### 3.7 AiStepper - 步骤组件

```tsx
<AiStepper
  steps={[
    { id: 'upload', title: '上传文件', status: 'completed' },
    { id: 'analyzing', title: '分析中', status: 'current' },
    { id: 'review', title: '审核', status: 'pending' },
  ]}
/>
```

### 3.8 AiConsole - 控制台组件

```tsx
<AiConsole
  events={executionEvents}
  autoScroll
  showTimestamp
/>
```

---

## 四、样式使用规范

### 4.1 颜色规范

**语义化颜色（强制使用）**：

```tsx
// 背景
className="bg-background"     // 页面背景
className="bg-card"           // 卡片背景
className="bg-muted"          // 柔和背景

// 文本
className="text-foreground"        // 主文本
className="text-muted-foreground"  // 次要文本
className="text-destructive"       // 错误文本

// 边框
className="border-border"     // 默认边框
className="border-input"      // 输入框边框
```

**状态颜色**：

```tsx
// 成功
className="bg-green-100 text-green-700"  // 浅色
className="bg-green-500 text-white"      // 深色

// 警告
className="bg-yellow-100 text-yellow-700"

// 错误
className="bg-red-100 text-red-700"

// 信息
className="bg-blue-100 text-blue-700"
```

### 4.2 间距规范

使用 Tailwind 间距类，基于 4px 网格：

```tsx
// 常用间距
className="p-2"   // 8px
className="p-4"   // 16px
className="p-6"   // 24px

className="gap-2" // 8px
className="gap-4" // 16px

className="space-y-4" // 子元素间距 16px
```

### 4.3 按钮规范

```tsx
// 主要操作
<Button variant="default">确定</Button>

// 次要操作
<Button variant="outline">取消</Button>

// 危险操作
<Button variant="destructive">删除</Button>

// 幽灵按钮
<Button variant="ghost">更多</Button>

// 链接样式
<Button variant="link">查看详情</Button>

// 图标按钮
<Button size="icon">
  <Plus className="h-4 w-4" />
</Button>
```

### 4.4 表单规范

```tsx
<form className="space-y-4">
  <div className="space-y-2">
    <Label htmlFor="name">客户名称</Label>
    <Input id="name" placeholder="请输入客户名称" />
  </div>
  
  <div className="space-y-2">
    <Label htmlFor="type">客户类型</Label>
    <Select>
      <SelectTrigger>
        <SelectValue placeholder="请选择" />
      </SelectTrigger>
      <SelectContent>
        <SelectItem value="enterprise">企业</SelectItem>
        <SelectItem value="individual">个人</SelectItem>
      </SelectContent>
    </Select>
  </div>
  
  <div className="flex justify-end gap-2">
    <Button variant="outline">取消</Button>
    <Button type="submit">提交</Button>
  </div>
</form>
```

### 4.5 表格规范

```tsx
<Table>
  <TableHeader>
    <TableRow>
      <TableHead className="w-[200px]">名称</TableHead>
      <TableHead className="w-[100px]">状态</TableHead>
      <TableHead>描述</TableHead>
      <TableHead className="w-[100px] text-right">操作</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    {data.map((item) => (
      <TableRow key={item.id}>
        <TableCell className="font-medium">{item.name}</TableCell>
        <TableCell>
          <Badge variant={item.status === 'active' ? 'default' : 'secondary'}>
            {item.statusLabel}
          </Badge>
        </TableCell>
        <TableCell className="text-muted-foreground">{item.description}</TableCell>
        <TableCell className="text-right">
          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <Button variant="ghost" size="icon">
                <MoreHorizontal className="h-4 w-4" />
              </Button>
            </DropdownMenuTrigger>
            <DropdownMenuContent align="end">
              <DropdownMenuItem>编辑</DropdownMenuItem>
              <DropdownMenuItem className="text-destructive">删除</DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
        </TableCell>
      </TableRow>
    ))}
  </TableBody>
</Table>
```

---

## 五、组件约束清单

### 5.1 必须遵守

| 规则 | 说明 |
|------|------|
| ✅ 只使用 shadcn/ui | 禁止其他 UI 库 |
| ✅ 只使用 Lucide Icons | 禁止其他图标库 |
| ✅ 使用 variant 属性 | 不自定义组件结构 |
| ✅ 使用 className 扩展 | 不使用内联样式 |
| ✅ AI 交互原语优先 | 复杂交互使用 Ai* 组件 |

### 5.2 禁止行为

| 禁止 | 原因 |
|------|------|
| ❌ 使用 Emoji | AI 无法解析 |
| ❌ 引入其他 UI 库 | 破坏一致性 |
| ❌ 魔改 shadcn 组件 | 破坏可预测性 |
| ❌ 内联样式 | 不可维护 |
| ❌ 硬编码颜色值 | 无法主题切换 |

### 5.3 PR 检查清单

- [ ] 是否只使用了 shadcn/ui 组件？
- [ ] 是否使用了 Emoji？（禁止）
- [ ] 是否使用了内联样式？（动态值除外）
- [ ] 组件是否可被 AI 理解和操作？
- [ ] 是否符合交互原语规范？

---

## 版本历史

| 版本 | 日期 | 变更 |
|------|------|------|
| v2.0 | 2025-12-28 | 重构为 dhs-atlas shadcn/ui 规范 |
| v1.0 | 2024-08-27 | 初始版本（Ant Design） |

---

**文档维护**: dhs-atlas 开发团队  
**最高约束**: [开发伦理与系统操作宪章](../开发伦理与系统操作宪章-最高指示.md)
