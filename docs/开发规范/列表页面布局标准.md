# 列表页面布局规范

> **版本**: v2.0  
> **更新日期**: 2025-12-28  
> **适用项目**: dhs-atlas（AI 原生工作操作系统）  
> **适用范围**: 系统中所有列表类页面

本文档定义了系统中所有列表页面的标准布局结构和样式规范。

---

## 一、AI 原生约束

### 1.1 核心原则

列表页面必须满足 AI 原生要求：

| 原则 | 说明 |
|------|------|
| **Command-First** | 所有操作必须先定义 Command |
| **状态可查询** | 列表状态可被 AI 结构化读取 |
| **操作等价** | AI 与人使用同一套操作接口 |
| **无 Emoji** | 状态使用结构化徽章，非 Emoji |

### 1.2 必须提供的 Command

每个列表页面必须注册以下 Command：

```typescript
// 列表查询
{ id: '[module].list', name: '查询列表' }

// 创建
{ id: '[module].create', name: '创建' }

// 编辑
{ id: '[module].update', name: '更新' }

// 删除
{ id: '[module].delete', name: '删除', level: 'L3' }

// 批量操作
{ id: '[module].batch', name: '批量操作' }
```

---

## 二、全局规则

### 2.1 布局基础

| 属性 | 规范值 | 说明 |
|------|--------|------|
| 页面最小宽度 | 1200px | 低于此宽度显示横向滚动条 |
| 页面内边距 | `p-6` (24px) | 页面容器内边距 |
| Card 圆角 | `rounded-lg` | 统一卡片圆角 |
| Card 间距 | `space-y-6` | Card 之间的垂直间距 |

### 2.2 响应式规则

```tsx
// 标准断点
// md (768px) - 平板
// lg (1024px) - 桌面
// xl (1280px) - 大屏

// 响应式布局示例
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
  {/* 统计卡片 */}
</div>
```

**原则**：
- ✅ 超宽屏幕：内容居中，最大宽度 1600px
- ✅ 标准屏幕：全宽铺开
- ✅ 窄屏幕（<1200px）：显示横向滚动条

---

## 三、页面结构概览

```
┌─────────────────────────────────────────────────────────────┐
│                    统计卡片区域（可选）                        │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐      │
│  │ 统计项1   │ │ 统计项2   │ │ 统计项3   │ │ 统计项4   │      │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘      │
├─────────────────────────────────────────────────────────────┤
│  Card: "列表名称"                                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 工具栏                                               │   │
│  │ ┌────────┐ ┌────────┐ ┌────────┐     ┌────────┐    │   │
│  │ │ 搜索框  │ │ 筛选1   │ │ 筛选2   │     │ 新建    │    │   │
│  │ └────────┘ └────────┘ └────────┘     └────────┘    │   │
│  └─────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                                                     │   │
│  │                    Table 列表                        │   │
│  │                                                     │   │
│  └─────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                    分页组件                          │   │
│  └─────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

---

## 四、布局类型

### 类型 A：带统计卡片的列表页

适用于：需要展示统计数据的页面

```tsx
export default function ListPage() {
  return (
    <div className="p-6 space-y-6">
      {/* 统计卡片区域 */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        <Card>
          <CardHeader className="pb-2">
            <CardDescription>总数</CardDescription>
            <CardTitle className="text-2xl">{stats.total}</CardTitle>
          </CardHeader>
        </Card>
        <Card>
          <CardHeader className="pb-2">
            <CardDescription>进行中</CardDescription>
            <CardTitle className="text-2xl text-blue-600">{stats.active}</CardTitle>
          </CardHeader>
        </Card>
        {/* 更多统计卡片 */}
      </div>

      {/* 主列表卡片 */}
      <Card>
        <CardHeader>
          <CardTitle>列表标题</CardTitle>
        </CardHeader>
        <CardContent>
          {/* 工具栏 */}
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center gap-2">
              <Input placeholder="搜索..." className="w-[200px]" />
              <Select>
                <SelectTrigger className="w-[150px]">
                  <SelectValue placeholder="状态筛选" />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="all">全部</SelectItem>
                  <SelectItem value="active">进行中</SelectItem>
                </SelectContent>
              </Select>
            </div>
            <Button>
              <Plus className="h-4 w-4 mr-2" />
              新建
            </Button>
          </div>
          
          {/* 表格 */}
          <DataTable columns={columns} data={data} />
        </CardContent>
      </Card>
    </div>
  )
}
```

### 类型 B：纯列表页（无统计卡片）

适用于：不需要统计数据的页面

```tsx
export default function ListPage() {
  return (
    <div className="p-6">
      <Card>
        <CardHeader>
          <CardTitle>列表标题</CardTitle>
        </CardHeader>
        <CardContent>
          {/* 工具栏 */}
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center gap-2">
              <Input placeholder="搜索..." className="w-[200px]" />
              <Select>...</Select>
            </div>
            <Button>
              <Plus className="h-4 w-4 mr-2" />
              新建
            </Button>
          </div>
          
          {/* 表格 */}
          <DataTable columns={columns} data={data} />
        </CardContent>
      </Card>
    </div>
  )
}
```

### 类型 C：仅筛选（无操作按钮）

适用于：只有筛选功能的页面

```tsx
export default function ListPage() {
  return (
    <div className="p-6">
      <Card>
        <CardHeader>
          <CardTitle>列表标题</CardTitle>
        </CardHeader>
        <CardContent>
          {/* 工具栏 - 只有筛选 */}
          <div className="flex items-center gap-2 mb-4">
            <Input placeholder="搜索..." className="w-[200px]" />
            <Select>...</Select>
            <Button variant="outline">清除筛选</Button>
          </div>
          
          {/* 表格 */}
          <DataTable columns={columns} data={data} />
        </CardContent>
      </Card>
    </div>
  )
}
```

---

## 五、组件规范

### 5.1 工具栏结构

**标准三层结构**：

```tsx
<div className="flex items-center justify-between mb-4">
  {/* 左侧：筛选区域 */}
  <div className="flex items-center gap-2">
    <Input placeholder="搜索..." className="w-[200px]" />
    <Select>...</Select>
    <Button variant="outline" size="sm">清除筛选</Button>
  </div>
  
  {/* 右侧：操作按钮 */}
  <div className="flex items-center gap-2">
    <Button variant="outline" size="icon">
      <RefreshCw className="h-4 w-4" />
    </Button>
    <Button>
      <Plus className="h-4 w-4 mr-2" />
      新建
    </Button>
  </div>
</div>
```

### 5.2 表单元素规范

| 组件类型 | 宽度 | className |
|---------|------|-----------|
| 搜索框 | 200px | `w-[200px]` |
| 筛选下拉框 | 150px | `w-[150px]` |
| 日期范围选择器 | 240px | `w-[240px]` |
| 单日期选择器 | 150px | `w-[150px]` |

### 5.3 表格组件

使用 TanStack Table + shadcn Table：

```tsx
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table"

<Table>
  <TableHeader>
    <TableRow>
      <TableHead className="w-[200px]">名称</TableHead>
      <TableHead className="w-[100px]">状态</TableHead>
      <TableHead>描述</TableHead>
      <TableHead className="w-[100px] text-right">操作</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    {data.map((item) => (
      <TableRow key={item.id}>
        <TableCell className="font-medium">{item.name}</TableCell>
        <TableCell>
          <Badge variant={getStatusVariant(item.status)}>
            {item.statusLabel}
          </Badge>
        </TableCell>
        <TableCell className="text-muted-foreground">
          {item.description}
        </TableCell>
        <TableCell className="text-right">
          <DropdownMenu>
            <DropdownMenuTrigger asChild>
              <Button variant="ghost" size="icon">
                <MoreHorizontal className="h-4 w-4" />
              </Button>
            </DropdownMenuTrigger>
            <DropdownMenuContent align="end">
              <DropdownMenuItem>编辑</DropdownMenuItem>
              <DropdownMenuItem className="text-destructive">
                删除
              </DropdownMenuItem>
            </DropdownMenuContent>
          </DropdownMenu>
        </TableCell>
      </TableRow>
    ))}
  </TableBody>
</Table>
```

### 5.4 分页组件

```tsx
<div className="flex items-center justify-between mt-4">
  <p className="text-sm text-muted-foreground">
    共 {total} 条，当前显示 {(page - 1) * pageSize + 1}-{Math.min(page * pageSize, total)} 条
  </p>
  <div className="flex items-center gap-2">
    <Button
      variant="outline"
      size="sm"
      disabled={page === 1}
      onClick={() => setPage(page - 1)}
    >
      上一页
    </Button>
    <span className="text-sm">
      {page} / {Math.ceil(total / pageSize)}
    </span>
    <Button
      variant="outline"
      size="sm"
      disabled={page >= Math.ceil(total / pageSize)}
      onClick={() => setPage(page + 1)}
    >
      下一页
    </Button>
  </div>
</div>
```

---

## 六、状态处理

### 6.1 加载状态

```tsx
{isLoading ? (
  <div className="flex items-center justify-center h-[200px]">
    <Loader2 className="h-6 w-6 animate-spin text-muted-foreground" />
  </div>
) : (
  <DataTable columns={columns} data={data} />
)}
```

### 6.2 空状态

```tsx
{data.length === 0 ? (
  <div className="flex flex-col items-center justify-center h-[200px] text-muted-foreground">
    <Inbox className="h-10 w-10 mb-2" />
    <p>暂无数据</p>
  </div>
) : (
  <DataTable columns={columns} data={data} />
)}
```

### 6.3 错误状态

```tsx
{error ? (
  <div className="flex flex-col items-center justify-center h-[200px]">
    <AlertCircle className="h-10 w-10 text-destructive mb-2" />
    <p className="text-destructive mb-4">{error.message}</p>
    <Button variant="outline" onClick={() => refetch()}>
      <RefreshCw className="h-4 w-4 mr-2" />
      重试
    </Button>
  </div>
) : (
  <DataTable columns={columns} data={data} />
)}
```

---

## 七、交互约定

### 7.1 搜索与筛选

| 交互类型 | 触发方式 | 说明 |
|---------|---------|------|
| 搜索框 | 按 Enter 或 debounce 300ms | 避免频繁请求 |
| 下拉筛选 | onChange 立即触发 | 选中后立即筛选 |
| 日期范围 | onChange 立即触发 | 选中后立即筛选 |
| 清除筛选 | 点击按钮 | 重置所有条件 |

### 7.2 操作反馈

| 操作 | 成功反馈 | 失败反馈 |
|------|---------|---------|
| 新建 | `toast.success('创建成功')` | `toast.error(message)` |
| 编辑 | `toast.success('更新成功')` | `toast.error(message)` |
| 删除 | `toast.success('删除成功')` | `toast.error(message)` |

### 7.3 删除确认

```tsx
<AlertDialog>
  <AlertDialogTrigger asChild>
    <Button variant="destructive">删除</Button>
  </AlertDialogTrigger>
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle>确认删除</AlertDialogTitle>
      <AlertDialogDescription>
        此操作无法撤销，确定要删除吗？
      </AlertDialogDescription>
    </AlertDialogHeader>
    <AlertDialogFooter>
      <AlertDialogCancel>取消</AlertDialogCancel>
      <AlertDialogAction onClick={handleDelete}>
        确认删除
      </AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>
```

---

## 八、禁止事项

### 8.1 禁止的布局方式

```tsx
// ❌ 错误 - 使用内联样式
<div style={{ padding: '24px' }}>

// ✅ 正确 - 使用 Tailwind
<div className="p-6">
```

```tsx
// ❌ 错误 - 使用 Emoji 作为状态
<span>✅ 已完成</span>

// ✅ 正确 - 使用 Badge
<Badge variant="success">已完成</Badge>
```

```tsx
// ❌ 错误 - 硬编码颜色
<span className="text-[#52c41a]">成功</span>

// ✅ 正确 - 使用语义化颜色
<span className="text-green-600">成功</span>
```

### 8.2 审查清单

- [ ] 是否使用了内联样式？
- [ ] 是否使用了 Emoji？
- [ ] 是否使用了硬编码颜色？
- [ ] 是否定义了对应的 Command？
- [ ] 状态是否可被 AI 查询？

---

## 九、命名规范

### 9.1 CSS 类名

采用语义化命名，使用 Tailwind 类组合：

```tsx
// 页面容器
className="p-6 space-y-6"

// 工具栏
className="flex items-center justify-between mb-4"

// 筛选区域
className="flex items-center gap-2"

// 操作区域
className="flex items-center gap-2"
```

### 9.2 组件命名

| 组件类型 | 命名规范 | 示例 |
|---------|---------|------|
| 页面组件 | PascalCase + Page | `ClientListPage` |
| 表格列定义 | camelCase + Columns | `clientColumns` |
| 数据类型 | PascalCase | `Client` |
| Hook | use + PascalCase | `useClients` |

---

## 版本历史

| 版本 | 日期 | 变更内容 |
|------|------|---------|
| **v2.0** | 2025-12-28 | 重构为 dhs-atlas shadcn/ui 规范 |
| **v1.2** | 2025-12-08 | 新增全局规则、交互约定、状态规范 |
| **v1.0** | 2025-01 | 初始版本 |

---

**文档维护**: dhs-atlas 开发团队  
**最高约束**: [开发伦理与系统操作宪章](../开发伦理与系统操作宪章-最高指示.md)
