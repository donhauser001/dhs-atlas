# 01 - 现状诊断与核心理念

> **所属文档**: AI 原生架构升级规划  
> **章节**: 一、二

---

## 一、现状问题诊断

### 1.1 核心问题总结

当前系统的 AI 能力存在以下结构性问题：

| 问题类型 | 具体表现 |
|----------|---------|
| **碎片化** | AI 功能分散在 6+ 个独立模块，每个页面独立入口 |
| **机械感** | 固定流程、进度条、结果列表，交互不自然 |
| **能力分散** | 解析/分析/扫描/生成各自为战，用户需手动串联 |
| **无系统架构** | 服务之间不知道彼此存在，缺少统一协调层 |
| **填充式体验** | 在传统 CRUD 页面上添加 AI 按钮，而非重新设计 |

### 1.2 根本原因

**缺少「AI Agent 层」**：系统按「功能模块」组织，而非按「用户任务」组织。用户需要学习工具的结构、记住功能的位置、手动串联流程，而不是直接表达需求让 AI 来完成。

### 1.3 当前 vs 应有体验对比

| 维度 | 当前系统（填充式） | AI 原生应有的体验 |
|------|-------------------|-------------------|
| **入口** | 6+ 个分散入口 | 单一对话入口，AI 自动路由 |
| **交互模式** | 表单 + 按钮触发 | 自然语言对话 |
| **上下文** | 每个会话独立 | 全局上下文感知 |
| **主动性** | 被动等待操作 | 主动提示、建议、预警 |
| **任务编排** | 用户手动串联 | AI 自动编排多步骤 |
| **反馈形式** | 进度条 + 列表 | 对话式解释和讨论 |

---

## 二、核心理念

### 2.1 统一 AI 助手

**核心思想**：不为每个模块单独开发 AI 组件，而是做一个整体的统一 AI 助手组件。

**形态设计**：
- 悬浮在页面右下角，随时可唤起
- 支持快捷键唤起（如 Cmd/Ctrl + K）
- 不打断用户当前工作流

**核心能力**：
- 自动感知当前页面所属模块
- 根据上下文推断可用操作
- 调用合适的工具和工作流
- 必要时自动切换页面

### 2.2 工具调用化

**概念**：将系统的各项能力抽象为「工具」，AI 根据用户意图自动选择和调用。

**工具分类**：
| 类型 | 示例 |
|------|------|
| 合同工具 | 解析合同、风险扫描、生成合同、导出文档 |
| 客户工具 | 查询客户、分析合作历史、创建客户 |
| 项目工具 | 创建项目、查询进度、任务分配 |
| 报价工具 | 计算报价、生成报价单、价格策略分析 |
| 系统工具 | 页面导航、发送通知、文件操作 |

**工具特性**：
- 每个工具有清晰的输入/输出定义
- 工具可标注适用的模块范围
- 工具支持进度报告（用于实时反馈）

### 2.3 工作流调用化

**概念**：将常见的多步骤任务编排为「工作流」，AI 可识别并自动执行。

**工作流示例**：
| 工作流 | 包含步骤 |
|--------|---------|
| 合同导入流程 | 上传 → 解析 → 结构分析 → 风险扫描 → 汇总报告 |
| 新合同创建流程 | 收集信息 → 匹配模板 → 生成合同 → 审核建议 |
| 客户跟进流程 | 查询客户 → 分析历史 → 生成建议 → 创建任务 |

**工作流特性**：
- 可通过关键词或意图触发
- 步骤之间自动传递数据
- 支持条件分支和错误处理
- 中间结果实时反馈

### 2.4 页面感知机制

**概念**：AI 助手能自动感知用户当前所在的页面和上下文。

**感知内容**：
| 信息类型 | 说明 |
|----------|------|
| 当前模块 | 合同/客户/项目/报价/模板等 |
| 页面类型 | 列表/详情/编辑/创建 |
| 当前实体 | 正在查看的具体记录（如某份合同） |
| 选中状态 | 列表中选中的项目 |
| 表单数据 | 编辑中的表单内容 |
| 可用操作 | 当前页面可执行的操作列表 |

**应用场景**：
- 用户在合同详情页说「分析风险」→ AI 知道要分析哪份合同
- 用户在列表页选中 3 个项目说「对比一下」→ AI 知道对比哪 3 个
- 用户说「创建项目」→ AI 根据当前页面判断是否需要跳转

### 2.5 跨模块导航

**概念**：当任务需要跨模块操作时，AI 可自动切换页面。

**交互模式**：
1. AI 判断需要跳转
2. 向用户说明原因（如「我需要跳转到客户详情页查看合作历史」）
3. 自动执行导航
4. 在新页面继续任务

**原则**：
- 导航前告知用户
- 导航后保持对话上下文
- 支持用户拒绝导航

### 2.6 IDE 化设计理念

**核心思想**：借鉴现代 IDE（如 VS Code、Cursor）的设计思路，让整个后台工具化，更利于 AI 工作，同时保留人工操作的完整能力。

**为什么选择 IDE 化**：

| 传统企业后台 | IDE 化设计 |
|-------------|-----------|
| 页面驱动，功能分散 | 工作区驱动，功能集中 |
| 菜单层层嵌套 | 命令面板快速定位 |
| 鼠标点击为主 | 键盘操作优先 |
| 难以被 AI 控制 | 操作可编程，AI 友好 |
| 功能入口隐藏在各处 | 统一的命令接口 |

**IDE 核心元素借鉴**：

| IDE 元素 | 在本系统中的对应 |
|----------|-----------------|
| **命令面板** (Cmd+P) | 全局命令搜索，快速执行任何操作 |
| **侧边栏** | 模块导航 + 当前上下文信息 |
| **编辑器区** | 主工作区，显示当前正在处理的内容 |
| **面板区** | AI 助手、输出日志、预览等 |
| **状态栏** | 当前状态、快捷信息 |
| **快捷键系统** | 常用操作都有快捷键 |

**命令面板设计**：
- 按 `Cmd/Ctrl + P` 唤起
- 支持模糊搜索所有可用命令
- 显示命令的快捷键
- 最近使用的命令优先
- AI 和人使用同一套命令接口

### 2.7 人机双轨操作原则

**核心思想**：任何一个操作，都必须确保人可以手动完成。AI 不是替代人，而是给人提供另一种更高效的操作方式。

**双轨设计**：
```
              ┌─────────────────────────────────────┐
              │           系统操作层                 │
              │  (统一的命令/工具/API 接口)         │
              └───────────────┬─────────────────────┘
                              │
              ┌───────────────┴───────────────┐
              │                               │
              ▼                               ▼
       ┌─────────────┐                ┌─────────────┐
       │   人工轨道   │                │   AI 轨道   │
       │             │                │             │
       │ • 点击按钮  │                │ • 自然语言  │
       │ • 表单填写  │                │ • 意图识别  │
       │ • 快捷键    │                │ • 自动调用  │
       │ • 命令面板  │                │ • 智能编排  │
       └─────────────┘                └─────────────┘
              │                               │
              └───────────────┬───────────────┘
                              │
                              ▼
                      ┌─────────────┐
                      │  执行结果   │
                      │  (相同的)   │
                      └─────────────┘
```

**关键原则**：

| 原则 | 说明 |
|------|------|
| **操作等价** | AI 执行的操作，人也能通过 UI 完成 |
| **结果一致** | 无论谁触发，最终效果完全相同 |
| **可审计** | 能看到 AI 做了什么，等价于人做了什么 |
| **可接管** | 任何时候人都可以接管，继续手动操作 |
| **可回退** | AI 的操作可以被人撤销或修改 |

**具体体现**：

1. **每个工具都有 UI 入口**
   - AI 调用 `scan_risks` 工具
   - 人可以点击「风险扫描」按钮，效果相同

2. **每个工作流都可手动执行**
   - AI 自动执行「合同导入流程」
   - 人可以一步步手动完成：上传 → 解析 → 分析 → 扫描

3. **命令面板是人机共用的接口**
   - 人输入命令：`scan risks`
   - AI 识别意图后调用同一命令

4. **AI 操作可视化**
   - AI 执行时，UI 上相应的按钮/区域会高亮
   - 让人知道「如果我手动做，应该点这里」

---

## 下一步

- [02-实时交互原则](./02-实时交互原则.md) - 了解真实交互设计
- [03-体验设计](./03-体验设计.md) - 了解完整的体验设计

