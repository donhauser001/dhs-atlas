# 03 - 体验设计

> **所属文档**: AI 原生架构升级规划  
> **章节**: 四

---

## 四、体验设计

### 4.1 IDE 化整体布局

**布局结构**：

```
┌─────────────────────────────────────────────────────────────────────┐
│  顶部栏：Logo + 全局搜索/命令面板入口 + 用户信息                      │
├───────────┬─────────────────────────────────────────┬───────────────┤
│           │                                         │               │
│  侧边栏   │              主工作区                    │   AI 助手    │
│           │                                         │   面板       │
│  • 模块   │   当前正在处理的内容                     │               │
│    导航   │   （列表/详情/编辑/预览）                │  • 对话      │
│           │                                         │  • 工具执行  │
│  • 收藏   │                                         │  • 快捷操作  │
│           │                                         │               │
│  • 最近   │                                         │               │
│                                                     │               │
├───────────┴─────────────────────────────────────────┴───────────────┤
│  状态栏：当前位置 + 选中状态 + 操作提示 + AI 状态                      │
└─────────────────────────────────────────────────────────────────────┘
```

**区域说明**：

| 区域 | 功能 | 特点 |
|------|------|------|
| **顶部栏** | 全局导航和命令入口 | 命令面板入口、全局搜索 |
| **侧边栏** | 模块导航、上下文信息 | 可折叠、显示当前位置 |
| **主工作区** | 核心内容展示和编辑 | 响应式、支持多种视图 |
| **AI 面板** | AI 助手交互区 | 可展开/收起、可拖拽调整宽度 |
| **状态栏** | 状态信息和快捷入口 | 显示当前上下文、AI 状态 |

### 4.2 命令面板设计

**唤起方式**：`Cmd/Ctrl + P` 或点击顶部搜索框

**功能**：
- 搜索并执行任何命令
- 模糊匹配，智能排序
- 显示快捷键
- 最近使用优先

**命令分类**：

| 类别 | 示例命令 |
|------|---------|
| 导航 | `前往合同列表`、`打开客户 XX` |
| 操作 | `新建合同`、`扫描风险`、`导出报告` |
| 视图 | `切换列表视图`、`显示筛选面板` |
| AI | `让 AI 分析`、`让 AI 生成` |

**交互流程**：
```
Cmd+P → 输入关键词 → 模糊匹配 → 选择命令 → 执行
         ↑                              │
         └── AI 也可以调用同样的命令 ────┘
```

### 4.3 AI 助手双区设计：对话流 + 画布

**核心概念**：AI 助手界面分为两个区域——**对话流**用于人机交流，**画布**用于实时操作。

**布局结构**：

```
┌─────────────────────────────────────────────────────────────────────┐
│                         AI 助手面板                                  │
├─────────────────────────────┬───────────────────────────────────────┤
│                             │                                       │
│        对话流区域            │              画布区域                  │
│                             │                                       │
│   ┌─────────────────────┐  │   ┌───────────────────────────────┐   │
│   │ 🤖 我来帮你创建客户 │  │   │                               │   │
│   └─────────────────────┘  │   │   ┌─────────────────────────┐ │   │
│                             │   │   │ 新建客户                │ │   │
│   ┌─────────────────────┐  │   │   ├─────────────────────────┤ │   │
│   │ 👤 好的             │  │   │   │ 客户名称: [██████████] │ │   │
│   └─────────────────────┘  │   │   │ 联系人:   [          ] │ │   │
│                             │   │   │ 电话:     [          ] │ │   │
│   ┌─────────────────────┐  │   │   │ 地址:     [          ] │ │   │
│   │ 🤖 请确认客户名称   │  │   │   └─────────────────────────┘ │   │
│   │    我已填入表单     │  │   │                               │   │
│   └─────────────────────┘  │   │   [保存]  [取消]              │   │
│                             │   │                               │   │
│   [输入消息...]      [发送] │   └───────────────────────────────┘   │
│                             │                                       │
└─────────────────────────────┴───────────────────────────────────────┘
```

**两个区域的职责**：

| 区域 | 职责 | 内容 |
|------|------|------|
| **对话流** | 人机交流、指令下达、结果说明 | 消息气泡、工具执行状态、AI 解释 |
| **画布** | 实际操作界面、数据展示 | 工具栏、表单、列表、详情卡片、预览、对比视图 |

### 4.4 画布顶部：AI 能力工具栏

**核心理念**：每个页面/模块切换时，画布顶部呈现当前可用的工具和工作流，让用户一目了然知道 AI 能做什么。

**布局结构**：

```
┌─────────────────────────────────────────────────────────────────────┐
│                           画布区域                                   │
├─────────────────────────────────────────────────────────────────────┤
│  📍 当前：客户管理                                                   │
│  ─────────────────────────────────────────────────────────────────  │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  🛠️ AI 工具                                                  │   │
│  │  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐                    │   │
│  │  │ 🔍  │ │ ➕  │ │ 📊  │ │ 📧  │ │ 📥  │                    │   │
│  │  │搜索 │ │新建 │ │分析 │ │发送 │ │导入 │                    │   │
│  │  │客户 │ │客户 │ │客户 │ │邮件 │ │客户 │                    │   │
│  │  └─────┘ └─────┘ └─────┘ └─────┘ └─────┘                    │   │
│  │                                                              │   │
│  │  ⚡ 工作流                                                    │   │
│  │  ┌───────────────┐ ┌───────────────┐ ┌───────────────┐      │   │
│  │  │ 📋 完整客户    │ │ 💰 客户报价    │ │ 📄 客户合同    │      │   │
│  │  │    建档流程    │ │    生成流程    │ │    签署流程    │      │   │
│  │  └───────────────┘ └───────────────┘ └───────────────┘      │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                      [当前操作内容区]                         │   │
│  │                       表单/列表/预览                          │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**不同模块的 AI 能力展示**：

| 模块 | AI 工具 | AI 工作流 |
|------|--------|---------|
| **客户管理** | 搜索客户、新建客户、分析客户、发送邮件、导入客户 | 完整建档、报价生成、合同签署 |
| **报价管理** | 创建报价、计算价格、对比报价、发送报价 | 智能报价、批量报价、报价转合同 |
| **合同管理** | 解析合同、风险扫描、生成合同、导出合同 | 合同全流程、模板分析、批量审核 |
| **项目管理** | 创建项目、分配任务、统计进度、生成报告 | 项目规划、进度追踪、结算流程 |
| **财务管理** | 生成发票、核对账单、统计收款、催款提醒 | 开票流程、对账流程、催款流程 |

**画布可承载的内容类型**：

| 类型 | 场景 | 示例 |
|------|------|------|
| **表单** | 创建/编辑数据 | 新建客户、编辑合同、创建项目 |
| **列表** | 选择/筛选数据 | 选择客户、选择模板、查看搜索结果 |
| **详情卡片** | 查看信息 | 客户详情、合同摘要、风险报告 |
| **对比视图** | 比较分析 | 合同条款对比、版本差异、报价对比 |
| **预览** | 查看结果 | 合同预览、报告预览、邮件预览 |
| **编辑器** | 内容编辑 | 合同编辑、模板编辑 |

### 4.5 对话流与画布的协作模式

**模式一：AI 投射 + 人操作**
```
对话流                          画布
──────                          ────
🤖 我打开客户创建表单了         →  [显示新建客户表单]
   你可以直接填写

                                    用户手动填写表单
                                    ↓
🤖 我看到你填了 XX 公司        ←  [表单内容变化]
   需要我帮你补充其他信息吗？
```

**模式二：AI 投射 + AI 操作**
```
对话流                          画布
──────                          ────
👤 帮我创建客户 XX 公司

🤖 好的，我来创建               →  [显示新建客户表单]
                                    [AI 自动填写: 客户名称]
🤖 正在填写客户信息...          →  [AI 自动填写: 其他字段]
                                    [字段依次高亮]

🤖 已填写完成，请确认           →  [表单已填写完毕]
   
👤 确认

🤖 创建成功！                   →  [显示客户详情卡片]
```

**模式三：人机交替操作**
```
对话流                          画布
──────                          ────
👤 帮我创建报价单

🤖 好的，请先选择客户           →  [显示客户选择列表]

                                    用户点击选择 XX 公司
                                    ↓
🤖 选择了 XX 公司               ←  [客户选中]
   我来帮你添加服务项

🤖 根据历史记录推荐             →  [显示服务项表单]
   以下服务项...                    [AI 自动添加推荐项]

👤 再加一个 Logo 设计

🤖 已添加                       →  [添加 Logo 设计行项]

👤 价格改成 8000

                                    用户手动修改价格字段
                                    ↓
🤖 价格已更新为 8000            ←  [价格变更]
   总金额 23,000 元
```

### 4.6 画布的视觉状态

**AI 操作时的视觉反馈**：

| 状态 | 视觉表现 |
|------|---------|
| AI 正在填写 | 字段边框高亮 + 打字动画 |
| AI 正在选择 | 选项悬停效果 + 点击动画 |
| AI 填写完成 | 短暂的成功色闪烁 |
| 等待人确认 | 确认按钮脉冲动画 |

**人操作时的 AI 感知**：
- 对话流显示「检测到你修改了 XXX」
- AI 可主动回应修改（如验证、建议）

### 4.7 AI 预判与备选指令设计

**核心理念**：AI 不仅响应用户，还要主动预判下一步，减少用户思考和输入成本。

**预判指令的呈现位置**：

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│   🤖 客户 XX 公司已创建成功！                                        │
│                                                                     │
│   ┌─────────────────────────────────────────────────────────────┐  │
│   │  💡 下一步你可能想：                                          │  │
│   │                                                              │  │
│   │  [为这个客户创建报价单]  [添加联系人]  [查看客户列表]          │  │
│   │                                                              │  │
│   │  [创建合同]  [关联到项目]                                     │  │
│   └─────────────────────────────────────────────────────────────┘  │
│                                                                     │
│   [输入消息，或点击上方快捷指令...]                          [发送]  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**预判指令的生成逻辑**：

| 依据 | 说明 | 示例 |
|------|------|------|
| **刚完成的操作** | 根据操作类型推荐后续步骤 | 创建客户 → 推荐创建报价/合同 |
| **当前页面上下文** | 根据所在模块推荐相关操作 | 在报价单页 → 推荐发送/转合同 |
| **业务流程** | 根据标准业务流推荐下一环节 | 报价确认 → 推荐生成合同 |
| **历史行为** | 根据用户习惯推荐常用操作 | 用户常在创建客户后添加联系人 |
| **未完成事项** | 提示待处理的任务 | 有 3 份合同待审核 |

**预判指令的类型**：

```
┌─────────────────────────────────────────────────────────────────────┐
│  💡 快捷指令（可直接执行的操作）                                      │
│                                                                     │
│  [📝 为这个客户创建报价单]     ← 点击直接执行                         │
│  [👤 添加联系人]                                                     │
│  [📄 创建设计合同]                                                   │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  💬 提示词模板（需要补充信息）                                        │
│                                                                     │
│  [帮我给 XX 公司发送报价单，服务内容是___]    ← 点击填入输入框        │
│  [分析一下这个客户的历史合作情况]                                     │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  ❓ 追问建议（引导深入探索）                                          │
│                                                                     │
│  [这个报价合理吗？]                                                   │
│  [有没有类似的历史报价参考？]                                         │
│  [行业平均价格是多少？]                                               │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**🔴 预判指令的核心约束**：

> **任何 Predicted Action，默认必须是"需人确认"的。**
> 
> 哪怕是 execute 类型，也必须：明确显示"将执行什么"、可被取消、可被拒绝。
> 
> **绝对禁止**：AI 看你可能要做 → 就帮你做了。

**点击预判指令后的行为**：

| 类型 | 点击后行为 | 关键约束 |
|------|-----------|---------|
| **execute（执行类）** | 显示执行计划 → 等待确认 → 执行 | ⚠️ 必须确认，不能直接执行 |
| **template（模板类）** | 填入输入框 → 光标定位空白处 → 等待用户补充 | 必须用户完成输入 |
| **question（追问类）** | 显示问题预览 → 确认发送 | 可直接发送（低风险） |

### 4.8 典型交互流程

**场景：人机协作 + 画布联动（完整示例）**

```
┌─────────────────────────────┬───────────────────────────────────────┐
│          对话流              │                画布                   │
├─────────────────────────────┼───────────────────────────────────────┤
│                             │                                       │
│ 👤 帮我分析这份合同         │                                       │
│    [上传文件]               │                                       │
│                             │                                       │
│ 🤖 好的，正在分析...        │   ┌─────────────────────────────┐     │
│                             │   │ 📄 合同解析中...             │     │
│    ┌───────────────────┐   │   │ ████████░░░░  68%           │     │
│    │ 🔄 解析合同        │   │   │                             │     │
│    │ ██████░░ 52%       │   │   └─────────────────────────────┘     │
│    └───────────────────┘   │                                       │
│                             │                                       │
│ 🤖 分析完成！发现 3 个      │   ┌─────────────────────────────┐     │
│    高风险问题               │   │ 📊 风险扫描报告              │     │
│                             │   ├─────────────────────────────┤     │
│    ⚠️ 付款条款风险高        │   │ 评分: 62/100                │     │
│    ⚠️ 知识产权条款不利      │   │                             │     │
│    ⚠️ 缺少取消补偿          │   │ ⚠️ 高风险 (3)               │     │
│                             │   │ • 付款条款 - 验收后60天     │     │
│    需要我帮你修改吗？       │   │ • 知识产权 - 签约即转让     │     │
│                             │   │ • 取消条款 - 无补偿         │     │
│                             │   │                             │     │
│ 👤 第一个付款条款我自己改   │   │ [查看详情] [一键修复]       │     │
│                             │   └─────────────────────────────┘     │
│                             │                                       │
│ 🤖 好的，我把付款条款打开   │   ┌─────────────────────────────┐     │
│    你可以直接编辑           │   │ ✏️ 编辑付款条款              │     │
│                             │   ├─────────────────────────────┤     │
│    [AI 在画布中打开编辑器]  │   │                             │     │
│                             │   │ 甲方应于验收合格后【60】   │     │
│                             │   │ 日内支付全部款项...         │     │
│                             │   │         ↑                   │     │
│                             │   │    [光标定位到此处]         │     │
│                             │   │                             │     │
│                             │   │ 💡 AI 建议: 改为 15-30 天   │     │
│                             │   │                             │     │
│                             │   └─────────────────────────────┘     │
│                             │                                       │
│                             │      [用户在画布中手动修改]          │
│                             │      将 60 改为 15                    │
│                             │                 ↓                     │
│ 🤖 检测到你把付款周期       │   ┌─────────────────────────────┐     │
│    从 60 天改为 15 天       │   │ ✏️ 编辑付款条款              │     │
│                             │   ├─────────────────────────────┤     │
│    这是个好修改！风险降低   │   │                             │     │
│                             │   │ 甲方应于验收合格后【15】   │     │
│                             │   │ 日内支付全部款项...         │     │
│ 👤 其他两个帮我自动改       │   │ ✅ 已修改                   │     │
│                             │   └─────────────────────────────┘     │
│                             │                                       │
│ 🤖 好的，我来处理剩下两个   │   ┌─────────────────────────────┐     │
│                             │   │ ✏️ 知识产权条款              │     │
│    ┌───────────────────┐   │   ├─────────────────────────────┤     │
│    │ 🔄 修改知识产权    │   │   │                             │     │
│    │ AI 正在编辑...     │   │   │ 原: 签约后版权归甲方       │     │
│    └───────────────────┘   │   │        ↓ [AI 正在修改]       │     │
│                             │   │ 改: 付清全款后版权归甲方   │     │
│ 🤖 已修改知识产权条款       │   │                             │     │
│    版权转让条件改为付清后   │   │ ✅ AI 已修改                │     │
│                             │   └─────────────────────────────┘     │
│    ┌───────────────────┐   │                                       │
│    │ 🔄 添加取消补偿    │   │   ┌─────────────────────────────┐     │
│    │ AI 正在添加...     │   │   │ ➕ 新增取消补偿条款         │     │
│    └───────────────────┘   │   ├─────────────────────────────┤     │
│                             │   │                             │     │
│ 🤖 已添加取消补偿条款       │   │ 如甲方取消项目，应按已      │     │
│                             │   │ 完成工作量比例支付费用...   │     │
│    全部修改完成！           │   │                             │     │
│    风险评分提升到 89/100    │   │ ✅ AI 已添加                │     │
│                             │   └─────────────────────────────┘     │
│    需要我导出修订版吗？     │                                       │
│                             │                                       │
│ [输入消息...]        [发送] │                                       │
└─────────────────────────────┴───────────────────────────────────────┘
```

---

## 下一步

- [04-架构概览](./04-架构概览.md) - 了解整体架构设计
- [05-工程架构-协议与包结构](./05-工程架构-协议与包结构.md) - 了解工程实现细节

