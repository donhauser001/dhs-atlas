# DHS-Atlas ä¼ä¸šç®¡ç†ç³»ç»Ÿ

> ä¸€ä¸ªé›†æˆ AI èƒ½åŠ›çš„ä¼ä¸šç®¡ç†ç³»ç»Ÿï¼ŒåŒ…å« CRMã€æŠ¥ä»·ç®¡ç†ã€æœåŠ¡æµç¨‹ç­‰åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¯åŠ¨](#å¿«é€Ÿå¯åŠ¨)
- [æœåŠ¡è¯¦æƒ…](#æœåŠ¡è¯¦æƒ…)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
- [ç¯å¢ƒå˜é‡](#ç¯å¢ƒå˜é‡)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ— ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DHS-Atlas ç³»ç»Ÿ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   å‰ç«¯       â”‚   â”‚   åç«¯ API   â”‚   â”‚      AI Agent          â”‚   â”‚
â”‚  â”‚  (Next.js)  â”‚â”€â”€â–¶â”‚  (Node.js)  â”‚â—€â”€â”€â”‚    (Python/DB-GPT)     â”‚   â”‚
â”‚  â”‚  :3001      â”‚   â”‚  :3000      â”‚   â”‚      :8000             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                       â”‚                 â”‚
â”‚                           â–¼                       â”‚                 â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                 â”‚
â”‚                    â”‚  MongoDB    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                    â”‚   :27017    â”‚                                  â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                           â”‚                                         â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                    â”‚ Mongo       â”‚   â”‚      LLM æœåŠ¡           â”‚   â”‚
â”‚                    â”‚ Express     â”‚   â”‚   (LMStudio/OpenAI)    â”‚   â”‚
â”‚                    â”‚  :8081      â”‚   â”‚   192.168.31.177:1234  â”‚   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹å¼ä¸€ï¼šå¼€å‘æ¨¡å¼ï¼ˆæ¨èæ—¥å¸¸å¼€å‘ä½¿ç”¨ï¼‰

éœ€è¦åŒæ—¶å¯åŠ¨ **4 ä¸ªç»ˆç«¯**ï¼š

| ç»ˆç«¯ | æœåŠ¡ | å‘½ä»¤ | ç«¯å£ |
|------|------|------|------|
| 1ï¸âƒ£ | Docker åŸºç¡€è®¾æ–½ | `docker-compose up` | 27017, 8081 |
| 2ï¸âƒ£ | åç«¯ API | `cd backend && npm run dev` | 3000 |
| 3ï¸âƒ£ | å‰ç«¯ | `cd frontend && npm run dev` | 3001 |
| 4ï¸âƒ£ | AI Agent (å¯é€‰) | `./scripts/start-agent.sh` | 8000 |

#### è¯¦ç»†æ­¥éª¤ï¼š

```bash
# ç»ˆç«¯ 1: å¯åŠ¨ Docker åŸºç¡€è®¾æ–½ï¼ˆMongoDB + Mongo Expressï¼‰
docker-compose up

# ç»ˆç«¯ 2: å¯åŠ¨åç«¯ API
cd backend
npm install  # é¦–æ¬¡è¿è¡Œéœ€è¦
npm run dev

# ç»ˆç«¯ 3: å¯åŠ¨å‰ç«¯
cd frontend
npm install  # é¦–æ¬¡è¿è¡Œéœ€è¦
npm run dev

# ç»ˆç«¯ 4: å¯åŠ¨ AI Agentï¼ˆå¯é€‰ï¼Œéœ€è¦æ—¶å¯åŠ¨ï¼‰
./scripts/start-agent.sh
```

### æ–¹å¼äºŒï¼šä¸€é”®å¯åŠ¨ï¼ˆéœ€è¦å…ˆå¯åŠ¨ Dockerï¼‰

```bash
# å…ˆå¯åŠ¨ Docker åŸºç¡€è®¾æ–½
docker-compose up -d

# ç„¶åè¿è¡Œå¯åŠ¨è„šæœ¬ï¼ˆå¯åŠ¨åç«¯+å‰ç«¯ï¼‰
./scripts/start-with-dbgpt.sh
```

### æ–¹å¼ä¸‰ï¼šå±€åŸŸç½‘éƒ¨ç½²ï¼ˆæœåŠ¡å™¨ç¯å¢ƒï¼‰

```bash
# ä½¿ç”¨å±€åŸŸç½‘é…ç½®å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose -f docker-compose.lan.yml up -d
```

---

## ğŸ“¦ æœåŠ¡è¯¦æƒ…

### 1. åŸºç¡€è®¾æ–½ï¼ˆDockerï¼‰

| æœåŠ¡ | å®¹å™¨å | ç«¯å£ | è¯´æ˜ |
|------|--------|------|------|
| MongoDB | donhauser-mongodb | 27017 | ä¸»æ•°æ®åº“ |
| Mongo Express | donhauser-mongo-express | 8081 | æ•°æ®åº“å¯è§†åŒ–ç®¡ç† |

**å¯åŠ¨å‘½ä»¤ï¼š**
```bash
docker-compose up       # å‰å°è¿è¡Œï¼ˆå¯æŸ¥çœ‹æ—¥å¿—ï¼‰
docker-compose up -d    # åå°è¿è¡Œ
docker-compose down     # åœæ­¢æœåŠ¡
```

**è®¿é—® Mongo Expressï¼š**
- åœ°å€ï¼šhttp://localhost:8081
- ç”¨æˆ·åï¼š`aiden`
- å¯†ç ï¼š`633234001`

---

### 2. åç«¯ API (Node.js/Express)

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| ç›®å½• | `backend/` |
| ç«¯å£ | 3000 |
| æ¡†æ¶ | Express + TypeScript |
| æ•°æ®åº“ | MongoDB (Mongoose) |

**å¯åŠ¨å‘½ä»¤ï¼š**
```bash
cd backend
npm install    # å®‰è£…ä¾èµ–
npm run dev    # å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run build  # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm start      # ç”Ÿäº§æ¨¡å¼
```

**ä¸»è¦åŠŸèƒ½ï¼š**
- RESTful API
- JWT è®¤è¯
- WebSocket (Socket.io)
- æ–‡ä»¶ä¸Šä¼ 
- AI å¯¹è¯æ¥å£

---

### 3. å‰ç«¯ (Next.js)

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| ç›®å½• | `frontend/` |
| ç«¯å£ | 3001 |
| æ¡†æ¶ | Next.js 16 + React 19 |
| UI | Tailwind CSS + Radix UI |

**å¯åŠ¨å‘½ä»¤ï¼š**
```bash
cd frontend
npm install    # å®‰è£…ä¾èµ–
npm run dev    # å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run build  # æ„å»º
npm start      # ç”Ÿäº§æ¨¡å¼
```

**è®¿é—®åœ°å€ï¼š** http://localhost:3001

---

### 4. AI Agent (Python/DB-GPT)

| é¡¹ç›® | è¯´æ˜ |
|------|------|
| ç›®å½• | `dhs_atlas_agent/` |
| ç«¯å£ | 8000 |
| æ¡†æ¶ | FastAPI + DB-GPT |
| Python | 3.10+ |

**å¯åŠ¨å‘½ä»¤ï¼š**
```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
./scripts/start-agent.sh

# æ–¹å¼äºŒï¼šæ‰‹åŠ¨å¯åŠ¨
python3 -m venv .venv
source .venv/bin/activate
pip install -r dhs_atlas_agent/requirements.txt
python -m dhs_atlas_agent.main --api
```

**åŠŸèƒ½ï¼š**
- CRM å·¥å…·ï¼ˆå®¢æˆ·æŸ¥è¯¢ã€æŠ¥ä»·å•ç®¡ç†ï¼‰
- æ•°æ®åº“å·¥å…·ï¼ˆé€šç”¨æŸ¥è¯¢ï¼‰
- æµå¼å¯¹è¯ API

**æ³¨æ„ï¼š** éœ€è¦é…ç½® LLM æœåŠ¡ï¼ˆè§ç¯å¢ƒå˜é‡ç« èŠ‚ï¼‰

---

## ğŸ”§ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
dhs-atlas/
â”œâ”€â”€ backend/                 # Node.js åç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/    # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ models/         # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ routes/         # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ services/       # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ai/             # AI ç›¸å…³
â”‚   â”‚   â””â”€â”€ app.ts          # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/               # Next.js å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/           # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ components/    # ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ api/           # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ hooks/         # è‡ªå®šä¹‰ Hooks
â”‚   â”‚   â””â”€â”€ styles/        # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ dhs_atlas_agent/        # Python AI Agent
â”‚   â”œâ”€â”€ agents/            # Agent å®šä¹‰
â”‚   â”œâ”€â”€ tools/             # AI å·¥å…·
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ api/               # FastAPI æœåŠ¡
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ apps/                   # æ‰©å±•åº”ç”¨ï¼ˆè§„åˆ’ä¸­ï¼‰
â”‚   â”œâ”€â”€ console/           # ç®¡ç†æ§åˆ¶å°
â”‚   â””â”€â”€ platform/          # å¹³å°ç®¡ç†
â”‚
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”‚   â”œâ”€â”€ å¼€å‘è§„èŒƒ/          # å¼€å‘è§„èŒƒæ–‡æ¡£
â”‚   â”œâ”€â”€ architecture/      # æ¶æ„æ–‡æ¡£
â”‚   â””â”€â”€ domain/            # é¢†åŸŸè®¾è®¡
â”‚
â”œâ”€â”€ scripts/               # è„šæœ¬
â”‚   â”œâ”€â”€ start-agent.sh     # å¯åŠ¨ AI Agent
â”‚   â”œâ”€â”€ start-with-dbgpt.sh # ä¸€é”®å¯åŠ¨
â”‚   â””â”€â”€ deploy-to-server.sh # éƒ¨ç½²è„šæœ¬
â”‚
â”œâ”€â”€ docker-compose.yml      # Docker é…ç½®ï¼ˆå¼€å‘ï¼‰
â”œâ”€â”€ docker-compose.lan.yml  # Docker é…ç½®ï¼ˆå±€åŸŸç½‘ï¼‰
â””â”€â”€ README.md              # æœ¬æ–‡ä»¶
```

### å¼€å‘è§„èŒƒ

âš ï¸ **é‡è¦ï¼šè¯·åŠ¡å¿…é˜…è¯»ä»¥ä¸‹è§„èŒƒæ–‡æ¡£**

| è§„èŒƒ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| UI æ ·å¼è§„èŒƒ | `docs/å¼€å‘è§„èŒƒ/UIæ ·å¼ä½¿ç”¨è§„èŒƒ.md` | CSS å˜é‡ä½¿ç”¨ã€ç¦æ­¢å†…è”æ ·å¼ |
| åˆ—è¡¨é¡µå¸ƒå±€ | `docs/å¼€å‘è§„èŒƒ/åˆ—è¡¨é¡µé¢å¸ƒå±€æ ‡å‡†.md` | åˆ—è¡¨é¡µç»Ÿä¸€å¸ƒå±€ |
| ç»„ä»¶æ ·å¼ | `docs/å¼€å‘è§„èŒƒ/ç»„ä»¶æ ·å¼è§„èŒƒ.md` | ç»„ä»¶æ ·å¼ç¼–å†™ |

---

## ğŸŒ ç¯å¢ƒå˜é‡

### åç«¯ (backend/.env)

```bash
# æ•°æ®åº“
MONGODB_URI=mongodb://localhost:27017/donhauser

# è®¤è¯
JWT_SECRET=your-super-secret-jwt-key

# æœåŠ¡
PORT=3000
NODE_ENV=development

# AI (å¯é€‰)
USE_DBGPT=true
DBGPT_BASE_URL=http://localhost:5670
DBGPT_MODEL=qwen3-coder-30b
```

### AI Agent

```bash
# MongoDB
MONGO_URI=mongodb://localhost:27017/
DATABASE_NAME=donhauser

# LLM æœåŠ¡
LLM_BASE_URL=http://192.168.31.177:1234
LLM_MODEL=qwen/qwen3-coder-30b
LLM_API_KEY=lm-studio

# API
API_PORT=8000
```

### å‰ç«¯ (frontend/.env.local)

```bash
NEXT_PUBLIC_API_URL=http://localhost:3000/api
NEXT_PUBLIC_AGENT_API=http://localhost:8000/api/agent
```

---

## â“ å¸¸è§é—®é¢˜

### Q: å¯åŠ¨æŠ¥é”™ MongoDB è¿æ¥å¤±è´¥ï¼Ÿ

ç¡®ä¿ Docker å·²å¯åŠ¨ MongoDBï¼š
```bash
docker-compose up mongodb
```

### Q: å‰ç«¯é¡µé¢æŠ¥ API é”™è¯¯ï¼Ÿ

1. ç¡®è®¤åç«¯å·²å¯åŠ¨ï¼š`curl http://localhost:3000/api/health`
2. æ£€æŸ¥å‰ç«¯ç¯å¢ƒå˜é‡é…ç½®

### Q: AI Agent æ— æ³•è¿æ¥ LLMï¼Ÿ

æ£€æŸ¥ LLM æœåŠ¡æ˜¯å¦è¿è¡Œï¼š
```bash
curl http://192.168.31.177:1234/v1/models
```

### Q: ç«¯å£è¢«å ç”¨ï¼Ÿ

```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :3000
lsof -i :3001
lsof -i :27017

# æ€æ‰è¿›ç¨‹
kill -9 <PID>
```

---

## ğŸ“Š ç«¯å£æ±‡æ€»

| ç«¯å£ | æœåŠ¡ | è¯´æ˜ |
|------|------|------|
| 3000 | åç«¯ API | Node.js Express |
| 3001 | å‰ç«¯ | Next.js |
| 8000 | AI Agent | Python FastAPI |
| 8081 | Mongo Express | æ•°æ®åº“ç®¡ç† |
| 27017 | MongoDB | æ•°æ®åº“ |
| 5670 | DB-GPT | AI æ¡†æ¶ï¼ˆå¯é€‰ï¼‰ |
| 1234 | LMStudio | LLM æœåŠ¡ï¼ˆå±€åŸŸç½‘ï¼‰ |

---

## ğŸ”„ æ—¥å¸¸å¼€å‘æµç¨‹

```bash
# 1. å¯åŠ¨ Dockerï¼ˆå¦‚æœæ²¡è¿è¡Œï¼‰
docker-compose up -d

# 2. å¯åŠ¨åç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd backend && npm run dev

# 3. å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd frontend && npm run dev

# 4. å¼€å§‹å¼€å‘ï¼
# å‰ç«¯: http://localhost:3001
# åç«¯ API: http://localhost:3000
# æ•°æ®åº“ç®¡ç†: http://localhost:8081
```

---

**æœ€åæ›´æ–°ï¼š** 2025-12-31

